var userUtilsPro,EVENT_TYPE=Enum.EVENT_TYPE;function runBg(r,t,e){var i=(t+e)/8;const n=50;let a,o,s=[],l={x:0,y:0,tx:-100,ty:100,z:5e-4};var h={};function d(t){t.x=Math.random()*a,t.y=Math.random()*o}return h.update=function(){l.tx*=.96,l.ty*=.96,l.x+=.8*(l.tx-l.x),l.y+=.8*(l.ty-l.y),s.forEach(t=>{if(t.x+=l.x*t.z,t.y+=l.y*t.z,t.x+=(t.x-a/2)*l.z*t.z,t.y+=(t.y-o/2)*l.z*t.z,t.z+=l.z,t.x<-n||t.x>a+n||t.y<-n||t.y>o+n){let e="z";var i=Math.abs(l.x),r=Math.abs(l.y);if(1<i||1<r){let t;t=r<i?Math.random()<i/(i+r)?"h":"v":Math.random()<r/(i+r)?"v":"h",e="h"===t?0<l.x?"l":"r":0<l.y?"t":"b"}t.z=.2+.8*Math.random(),"z"===e?(t.z=.1,t.x=Math.random()*a,t.y=Math.random()*o):"l"===e?(t.x=-n,t.y=o*Math.random()):"r"===e?(t.x=a+n,t.y=o*Math.random()):"t"===e?(t.x=a*Math.random(),t.y=-n):"b"===e&&(t.x=a*Math.random(),t.y=o+n)}})},h.render=function(){var t=a>o?a:o,e=(r.fillStyle="#000000",r.fillRect(0,0,a,o),r.fillStyle=null,r.createRadialGradient(0,0,0,0,0,a>o?a:o));e.addColorStop(0,"rgba(121, 68, 154, 0.13)"),e.addColorStop(1,"rgba(0, 0, 0, 0)"),r.fillStyle=e,r.fillRect(0,0,a,o),r.fillStyle=null,(e=r.createRadialGradient(20*a/100,20*o/100,20*t/100,20*a/100,20*o/100,80*(a>o?a:o)/100)).addColorStop(0,"rgba(41, 196, 255, 0.13)"),e.addColorStop(1,"rgba(0, 0, 0, 0)"),r.fillStyle=e,r.fillRect(0,0,a,o),r.fillStyle=null,s.forEach(t=>{r.beginPath(),r.lineCap="round",r.lineWidth=3*t.z*1,r.strokeStyle="rgba(255,255,255,"+(.5+.5*Math.random())+")",r.beginPath(),r.moveTo(t.x,t.y);var e=2*l.x,i=2*l.y;Math.abs(e)<.1&&(e=.5),Math.abs(i)<.1&&(i=.5),r.lineTo(t.x+e,t.y+i),r.stroke()})},h.updateStarts=function(){s=[];for(let t=0;t<i;t++)s.push({x:0,y:0,z:.2+.8*Math.random()})},h.resize=function(t,e){i=(t+e)/8,h.updateStarts(),t=t,e=e,a=+t,o=+e,s.forEach(d)},h.velocity=l,h}function runTitle(e,t,i){var o=10,s=t,l=i;function r(t){for(var e=[],i=0;i<t.width/o;i++)for(var r=0;r<t.height/o;r++){var n,a=4*Math.floor(r*o*t.width+i*o+o/2);t.data[a]&&(a={x:i*o+(s-t.width)/2,y:r*o+(l-t.height)/2-140},n=.5<userUtilsPro.rand()?1:-1,e.push(new h({x:a.x,y:a.y+n*userUtilsPro.randBetween(100,300)},a)))}return e}function h(t,e){this.start=t,this.end=e,this.startColor=[100,200,50,1],this.endColor=[255,50,255,1],this.t=0,this.x=0,this.y=0,this.isEnd=!1,this.tMult=5/userUtilsPro.pointsDis(this.start,this.end),this.getColor=function(){var t=this.t,e=userUtilsPro.oneBezier(this.startColor[0],this.endColor[0],t),i=userUtilsPro.oneBezier(this.startColor[1],this.endColor[1],t),r=userUtilsPro.oneBezier(this.startColor[2],this.endColor[2],t);userUtilsPro.oneBezier(this.startColor[3],this.endColor[3],t);return"rgba("+e+","+i+","+r+",1)"},this.update=function(){1<=this.t?(this.t=0,this.isEnd=!0):this.t+this.tMult<=1?this.t+=this.tMult:this.t=1,this.isEnd||(this.x=userUtilsPro.oneBezier(this.start.x,this.end.x,this.t),this.y=userUtilsPro.oneBezier(this.start.y,this.end.y,this.t))},this.draw=function(t){t.save(),t.beginPath(),t.stroke,t.lineWidth=1,t.fillStyle=this.getColor(),t.arc(this.x,this.y,o/2,0,2*Math.PI),t.fill(),t.restore()}}t="阻止传送",i=140,n=document.createElement("canvas"),(a=n.getContext("2d")).fillStyle="#FFFFFF",a.textAlign="left",a.textBaseline="top",a.font="bold "+i+"px Arial",d=a.measureText(t).width,n.width=d,n.height=i,(a=n.getContext("2d")).fillStyle="#FFFFFF",a.textAlign="left",a.textBaseline="top",a.font="bold "+i+"px Arial",a.fillText(t,0,0);var n,a,d,c=a.getImageData(0,0,d,i),u=r(c);return{render:function(){for(var t=0;t<u.length;t++)u[t].draw(e)},resize(t,e){s=t,l=e,u=r(c),this.update(),this.render()},update:function(){for(var t=0;t<u.length;t++)u[t].update(e)}}}Game.on(EVENT_TYPE.OPEN_LOADED_SCENEED,function(t){var e=Game.getSceneSbRect(),i=userUtilsPro.createCvsTexture(),r=(Game.addNowSceneUiChild(i),i.setCvsWidth(e.width),i.setCvsHeight(e.height),Game.set("startBg",i),Game.createImageButton("plist_comm_none2_btn.png","plist_comm_none2_btn.png","开始游戏",150,40,{txtOffsetY:-2})),n=(r.con.x=e.width/2-r.con.width/2,r.con.y=e.height/2-r.con.height/2-40,r.txt.style.fill=16777215,Game.createImageButton("plist_comm_none2_btn.png","plist_comm_none2_btn.png","选项",150,40,{txtOffsetY:-2})),a=(n.con.x=e.width/2-n.con.width/2,n.con.y=e.height/2-n.con.height/2+10,n.txt.style.fill=16777215,i.getCtx()),o=runBg(a),s=(o.resize(e.width,e.height),!1),l=runTitle(a);l.resize(e.width,e.height);var h=Game.setIntervalGame(function(){a.clearRect(0,0,e.width,e.height),o.update(),o.render(),s&&(l.update(),l.render()),i._update(),s||0!==parseInt(o.velocity.tx)||0!==parseInt(o.velocity.ty)||(s=!0,Game.addNowSceneUiChild(r.con),Game.addNowSceneUiChild(n.con))},0);r.con.onClick=function(){o.velocity.z=.04,Game.setTimeout(function(){Game.loadServerScene("scene/selectALevel.json")},500)},Game.set("timmer1",h)}),Game.on(EVENT_TYPE.CLOSE_SCENE,function(){Game.clearTimeGame(Game.get("timmer1")),Game.get("startBg").destroy(),Game.destory()});